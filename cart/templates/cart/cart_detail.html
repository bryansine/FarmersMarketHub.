{% extends "base.html" %}
{% block title %}Your Cart{% endblock %}
{% block content %}
<style>
.cart-wrap { max-width:900px; margin:40px auto; }
.cart-item { display:flex; gap:16px; padding:14px; border-bottom:1px solid #eee; align-items:center; }
.cart-item img { width:100px; height:80px; object-fit:cover; border-radius:6px; }
.qty-form input { width:64px; padding:6px; border-radius:6px; }
.checkout-btn { background:#2e8b57;color:white;padding:10px 16px;border-radius:8px;text-decoration:none; }
</style>

<div class="cart-wrap">
  <h1>Your Cart</h1>

  {% if items %}
    {% for item in items %}
      <div class="cart-item">
        {% if item.product.image %}
          <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}">
        {% endif %}
        <div style="flex:1;">
          <strong>{{ item.product.name }}</strong><br>
          KES {{ item.product.price }} / {{ item.product.unit_of_measure }}<br>
          <form action="{% url 'cart:update' item.pk %}" method="post" class="qty-form" style="display:inline-block; margin-top:8px;">
            {% csrf_token %}
            <input type="number" name="quantity" value="{{ item.quantity }}" min="1" max="{{ item.product.stock_quantity }}">
            <button type="submit">Update</button>
          </form>
          <a href="{% url 'cart:remove' item.pk %}" style="margin-left:10px;color:#c62828;">Remove</a>
        </div>
        <div>
          <strong>KES {{ item.line_total|floatformat:2 }}</strong>
        </div>
      </div>
    {% endfor %}

    <div style="text-align:right; margin-top:20px;">
      <p>Total: <strong>KES {{ total|floatformat:2 }}</strong></p>
      <a href="{% url 'orders:checkout' %}" class="checkout-btn">Proceed to Checkout</a>
    </div>

  {% else %}
    <p>Your cart is empty.</p>
  {% endif %}
</div>
{% endblock %}